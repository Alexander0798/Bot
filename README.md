# Bot
запись
# Виджет для amoCRM "Умные Задачи REON" 
[Название продукта]:[№ заказа],[Город],[Дата]

Техническое задание для разработки публичной интеграции amoCRM (виджета) “Задачи 2.0”

Основная задача: Виджет позволяет настраивать автоматическую постановку задач на любом этапе воронки продаж. При движении сделки по воронке продаж или создании сделки в любом этапе воронки, необходимо создавать задачу по настраиваемым параметрам. Задача создается в сделке или в основном контакте, который прикреплен к карточке сделки или в карточке компании, которая прикреплена к карточке сделки. 

Тип виджета: платный.

Тестовый период виджета: 14 дней.

Дополнительно: все окна, чек-боксы, поля, шрифт и весь остальной интерфейс настройки и работы с виджетом должен быть максимально похож или идентичен стандартному интерфейсу amoCRM.

Области использования виджета:  
Область настроек;
Digital Pipeline;
Дополнительные настройки
Карточка сделки;
Карточка контакта;
Карточка компании.

Модальное окно главных настроек виджета: 
Окно настроек должно содержать поля для ввода данных пользователя. 
- Имя,
- Телефон.
По нажатию на кнопку сохранить, должен отправляться запрос на widget_controller для регистрации клиента в аккаунте REON.PRO.

Модальное окно настроек в Digital Pipeline: 
Основные настройки виджета должны производиться в цифровой воронке. 
При открытии модального окна  настроек, клиенту должно быть доступно указать следующий ряд настроек. Настройки должны быть выполнены в виде полей, списковых полей или чекбоксов: 

“Для всех сделок у которых:”
Добавить условие (стандартное поле, как в amoCRM):

Выполнить (стандартное поле, как в amoCRM):

Создавать задачу: 
Для сделки; (дефолтное поле)
Для основного контакта;
Для компании;

Установить дедлайн: 
По дате; (дефолтное значение)
По дате и времени.

Дата дедлайна:
Данное поле отображается, если выбрано поле создать дедлайн по дате. 

Варианты выбора для данного поля должны считываться из полей всех сущностей в amoCRM. (сделка, контакт, компания).

Должны считываться поля имеющие только тип  «Дата».

Если полей в сущностях с типом дата нет, то указывается дефолтное поле «В день события».

Корректировка даты дедлайна: 
Данное поле отображается, если выбрано поле установить дедлайн по дате. 

В случае, если дата дедлайна должна быть динамически скорректирована, то в данное поле необходимо указать, то количество дней которое необходимо добавить или отнять от поля «Дата дедлайна».

Из выпадающего списка должна быть возможность выбрать “+” или “-” (отнять или прибавить дни) и в соседнем списке должна быть возможность указать числовое значение (дней). Пример поля:

Но можно сделать корректировку даты дедлайна и выбор поля, как это реализовано в amoCRM (часы поменять на дни):


Дата и время дедлайна: 

Данное поле отображается, если выбрано поле создать дедлайн по дате и времени. 

Варианты выбора для данного поля должны считываться из полей всех сущностей в amoCRM. (сделка, контакт, компания).

Должны считываться поля имеющие только тип  «Дата и время».

Если полей в сущностях с типом дата и время нет, то указывается дефолтное поле «В момент события».

Корректировка даты и времени дедлайна: 

Данное поле отображается, если выбрано поле создать дедлайн по дате и времени.

В случае, если дата и время дедлайна должна быть динамически скорректированы, то в данное поле необходимо указать, то количество дней, часов и минут, которое необходимо добавить или отнять от поля «Дата и время дедлайна».

Из выпадающего списка должна быть возможность выбрать “+” или “-” (отнять или прибавить дни, часы и минуты) и в соседнем списке должна быть возможность указать числовое значение (дней). Пример поля:


Но можно сделать корректировку даты дедлайна и выбор поля, как это реализовано в amoCRM (но добавить еще бокс для выбора дней и минут):


Продолжительность задачи:

Дает возможность дополнительно выбрать продолжительность выполнения задачи. Если поле “Точное время” активно и в нем стоит галочка, то далее можно настроить  время старта задачи и её длительность (но не превышая 23:59):


Если в поле “Точное время” не стоит галочка и в поле Установить дедлайн: “По дате и времени.”  то задача становится на указанную дату и время в полях дедлайна продолжительностью 15 минут.

Если в поле “Точное время” не стоит галочка и в поле Установить дедлайн: “По дате”, то   при постановке задачи, задача становится на указанную дату без продолжительности и дедлайном до 23:59. В amoCRM происходит такая постановка задач если не указано точное время выполнения, в стандартных настройках это выглядит так: 

Учитывать дубль задачи: 

Поле должно быть типа флаг. При указании учитывать дубли, сделка должна проверяться на наличие дублирующей задачи. Критерием дублирующей задачи является, задача такого же типа, тексты задач и ответственный – идентичные.

В случае, если флаг установлен, то дублирующие задачи не создаются.

Создание просроченных задач: 

Поле типа флаг. В случае, если данный флаг активный, то разрешать любую  постановку задач. В случае, если данный флаг не активный, то проверять задачи на дедлайн. Если задача просрочена не создавать ее. 

Ответственный: (стандартное поле amoCRM)

В данное поле, списком выгружаются все активные пользователи crm системы и указывается ответственный пользователь на которого будет ставиться новая задача создаваемая виджетом. 

Можно выбрать только одного ответственного.
По дефолту можно оставить текущего ответственного за сделку или контакт. 

Тип задачи:  (стандартное поле amoCRM)

В данное поле выгружается все типы задач, которые зарегистрированы в аккаунте crm системы. 

Можно выбрать только один тип задачи.

Ниже пример стандартных полей в amoCRM Ответственный и Тип задачи:

Текст задачи: (стандартное поле amoCRM с доп. функционалом)

Данное поле должно быть текстовой областью. В данное поле, пользователь вписывает текст который добавляется к задаче. 

Пример стандартного поля в amoCRM:

Необходимо реализовать возможность подстановки в текст задачи данных из сущностей системы (карточки сделки/контакта/компании). 

Пользователь должен по клику добавлять любое значение из полей в текст задачи. При постановке задачи, в тексте должно выводиться значение данного поля. 

*Добавить поле в текст задачи:


Окно дополнительных настроек:

В окне дополнительных настроек реализовать интерфейс и логику позволяющую отслеживать изменение полей. 

Интерфейс должен иметь возможность выбрать воронку и этап на котором установлен виджет в цифровой воронке и установить возможность корректировать задачу при изменении поля и избавить менеджера от ручного изменения дедлайна. 

При необходимости продублировать интерфейсы полей из цифровой воронки.

Полезные ссылки:
Видео работы виджета наших конкурентов: 
https://www.youtube.com/watch?v=KTx77KKBgRo

